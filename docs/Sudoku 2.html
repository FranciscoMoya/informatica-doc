<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml" lang="es">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>54. Resolución de Sudokus</title>
    
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-3.0.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/codemirror.css" type="text/css" />
    <link rel="stylesheet" href="_static/activecode.css" type="text/css" />
    <link rel="stylesheet" href="_static/clickable.css" type="text/css" />
    <link rel="stylesheet" href="_static/pytutor.css" type="text/css" />
    <link rel="stylesheet" href="_static/modal-basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/datafile.css" type="text/css" />
    <link rel="stylesheet" href="_static/dragndrop.css" type="text/css" />
    <link rel="stylesheet" href="_static/fitb.css" type="text/css" />
    <link rel="stylesheet" href="_static/codemirror.css" type="text/css" />
    <link rel="stylesheet" href="_static/livecode.css" type="text/css" />
    <link rel="stylesheet" href="_static/parsons.css" type="text/css" />
    <link rel="stylesheet" href="_static/lib/prettify.css" type="text/css" />
    <link rel="stylesheet" href="_static/poll.css" type="text/css" />
    <link rel="stylesheet" href="_static/tabbedstuff.css" type="text/css" />
    <link rel="stylesheet" href="_static/video.css" type="text/css" />
    <link rel="stylesheet" href="_static/jquery-ui-1.10.3.custom.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/user-highlights.css" type="text/css" />
    <link rel="stylesheet" href="_static/runestone-custom-sphinx-bootstrap.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/runestonebase.js"></script>
    <script type="text/javascript" src="_static/codemirror.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/jquery.highlight.js"></script>
    <script type="text/javascript" src="_static/bookfuncs.js"></script>
    <script type="text/javascript" src="_static/codemirror.js"></script>
    <script type="text/javascript" src="_static/xml.js"></script>
    <script type="text/javascript" src="_static/css.js"></script>
    <script type="text/javascript" src="_static/htmlmixed.js"></script>
    <script type="text/javascript" src="_static/python.js"></script>
    <script type="text/javascript" src="_static/javascript.js"></script>
    <script type="text/javascript" src="_static/activecode.js"></script>
    <script type="text/javascript" src="_static/skulpt.min.js"></script>
    <script type="text/javascript" src="_static/skulpt-stdlib.js"></script>
    <script type="text/javascript" src="_static/clike.js"></script>
    <script type="text/javascript" src="_static/timed_activecode.js"></script>
    <script type="text/javascript" src="_static/animationbase.js"></script>
    <script type="text/javascript" src="_static/mchoice.js"></script>
    <script type="text/javascript" src="_static/timedmc.js"></script>
    <script type="text/javascript" src="_static/timed.js"></script>
    <script type="text/javascript" src="_static/clickable.js"></script>
    <script type="text/javascript" src="_static/timedclickable.js"></script>
    <script type="text/javascript" src="_static/d3.v2.min.js"></script>
    <script type="text/javascript" src="_static/jquery.ba-bbq.min.js"></script>
    <script type="text/javascript" src="_static/jquery.jsPlumb-1.3.10-all-min.js"></script>
    <script type="text/javascript" src="_static/pytutor.js"></script>
    <script type="text/javascript" src="_static/codelens.js"></script>
    <script type="text/javascript" src="_static/skulpt.min.js"></script>
    <script type="text/javascript" src="_static/skulpt-stdlib.js"></script>
    <script type="text/javascript" src="_static/datafile.js"></script>
    <script type="text/javascript" src="_static/dragndrop.js"></script>
    <script type="text/javascript" src="_static/timeddnd.js"></script>
    <script type="text/javascript" src="_static/fitb.js"></script>
    <script type="text/javascript" src="_static/timedfitb.js"></script>
    <script type="text/javascript" src="_static/livecode.js"></script>
    <script type="text/javascript" src="_static/clike.js"></script>
    <script type="text/javascript" src="_static/lib/prettify.js"></script>
    <script type="text/javascript" src="_static/lib/hammer.min.js"></script>
    <script type="text/javascript" src="_static/parsons.js"></script>
    <script type="text/javascript" src="_static/timedparsons.js"></script>
    <script type="text/javascript" src="_static/poll.js"></script>
    <script type="text/javascript" src="_static/reveal.js"></script>
    <script type="text/javascript" src="_static/shortanswer.js"></script>
    <script type="text/javascript" src="_static/timed_shortanswer.js"></script>
    <script type="text/javascript" src="_static/tabbedstuff.js"></script>
    <script type="text/javascript" src="_static/translations.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/jquery-ui-1.10.3.custom.min.js"></script>
    <script type="text/javascript" src="_static/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.0.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <script type="text/javascript" src="_static/waypoints.min.js"></script>
    <script type="text/javascript" src="_static/rangy-core.js"></script>
    <script type="text/javascript" src="_static/rangy-textrange.js"></script>
    <script type="text/javascript" src="_static/rangy-cssclassapplier.js"></script>
    <script type="text/javascript" src="_static/user-highlights.js"></script>
    <script type="text/javascript" src="_static/jquery.idle-timer.js"></script>
    <script type="text/javascript" src="_static/processing-1.4.1.min.js"></script>
    <script type="text/javascript" src="_static/jquery.hotkey.js"></script>
    <script type="text/javascript" src="_static/jquery-migrate-1.2.1.min.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="author" title="Sobre este documento" href="about.html" />
    <link rel="index" title="Índice" href="genindex.html" />
    <link rel="search" title="Búsqueda" href="search.html" />
    <link rel="next" title="55. Sudoku al estilo de P. Norvig" href="Sudoku 3.html" />
    <link rel="prev" title="53. Sopa de letras" href="sopa_letras.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
<link rel="shortcut icon" href="/runestone/static/favicon.ico" type="image/ico" />

<script type="text/javascript">
  eBookConfig = {};
  eBookConfig.host = 'http://127.0.0.1:8000' ? 'http://127.0.0.1:8000' : 'http://127.0.0.1:8000';
  eBookConfig.app = eBookConfig.host+'/runestone';
  eBookConfig.ajaxURL = eBookConfig.app+'/ajax/';
  eBookConfig.course = 'CS101';
  eBookConfig.logLevel = 0;
  eBookConfig.loginRequired = false;
  eBookConfig.build_info = "unknown";
  eBookConfig.isLoggedIn = false;
  eBookConfig.useRunestoneServices = false;
  eBookConfig.python3 = true;
  eBookConfig.basecourse = 'informatica';
  eBookConfig.runestone_version = '2.7.11';
</script>

<div id="fb-root"></div>
<script>
  (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&status=0";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));
</script>



  </head>
  <body role="document">


<!-- Begin navbar -->
<div id="navbar" class="navbar navbar-default navbar-fixed-top" role="navigation">

  <div class="container">

    <div class="navbar-header">
      <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
      <button type='button' class='navbar-toggle' data-toggle="collapse" data-target=".navbar-ex1-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div>
        <div style='float:left;display:block;background-size:90px 40px !important;height:40px;width:90px;background:transparent url("_static/eii_small.png") no-repeat 0px 0px;'>&nbsp; </div>
        <a class="navbar-brand" href="index.html">Informática</a>
      </div>
    </div>

    <div class="navbar-collapse collapse navbar-ex1-collapse">

      <ul class="nav navbar-nav navbar-right">

        <!--<li class="divider-vertical"></li>-->
        
          <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Ir a <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"><ul>
<li><a class="reference internal" href="#">54. Resolución de Sudokus</a><ul>
<li><a class="reference internal" href="#modelo-de-sudoku">54.1. Modelo de Sudoku</a></li>
<li><a class="reference internal" href="#comprobaciones-del-invariante-de-representacion">54.2. Comprobaciones del invariante de representación</a></li>
<li><a class="reference internal" href="#creacion-de-sudokus">54.3. Creación de Sudokus</a></li>
<li><a class="reference internal" href="#restricciones-con-clases">54.4. Restricciones con clases</a></li>
<li><a class="reference internal" href="#sudokus-dificiles">54.5. Sudokus difíciles</a></li>
</ul>
</li>
</ul>
</ul>
</li>
          <!--<li class="divider-vertical"></li>-->
        
        <!--
          
  <li id="relations-prev" title="Previous Chapter - 53. Sopa de letras" data-toggle="tooltip">
    <a href="sopa_letras.html" >
      <i class='glyphicon glyphicon-backward' style='opacity:0.9;'></i>
    </a>
  </li>
  
  <li id="relations-next" title='Next Chapter - 55. Sudoku al estilo de P. Norvig' data-toggle="tooltip" >
    <a href="Sudoku 3.html" >
      <i class='glyphicon glyphicon-forward' style='opacity:0.9;'></i>
    </a>
  </li>
  <li class="divider-vertical"></li>

<script type="text/javascript">
  opts = {'placement':'bottom',
          'selector': '',
          'delay': { show: 100, hide: 50}
         };

  $('#relations-prev').tooltip(opts);
  $('#relations-next').tooltip(opts);
</script>
        -->

        <li class="divider-vertical"></li>

        <!-- search dropdown -->
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-search" style='opacity:0.9;'></i>
          </a>
          <ul class='dropdown-menu'>
            
                <li><a href='index.html'>Índice del libro</a></li>
            
            <li><a href="genindex.html">Índice alfabético</a></li>
            <li class="divider"></li>
            <li id="scratch_ac_link"><a href="javascript:ACFactory.toggleScratchActivecode()">Código activo de prueba</a></li>
            <li class="divider"></li>
            <li style="width: 240px;">
              <form class="navbar-search" style="margin:10px;" action="search.html" method="get">
                <div class="input-group">
                  <input type="text" class="form-control" name="q" placeholder="Buscar en el libro" />
                  <span class="input-group-btn">
                    <button class="btn btn-primary" style="margin:0;" type="submit">
                      <i class="glyphicon glyphicon-search"></i>
                    </button>
                  </span>
                </div><!-- /input-group -->
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
            </li>
          </ul>
        </li>
        <!-- end search dropdown -->

        
        <li class="divider-vertical"></li>

        <!-- help menu dropdown -->
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-question-sign" style="opacity:0.9;"></i>
          </a>
          <ul class="dropdown-menu user-menu">
            <li><a href="_static/navhelp.html">Ayuda a la navegación</a></li>
            
            <li>
  <a href="_sources/Sudoku 2.rst.txt"
     rel="nofollow">Ver fuente</a></li>
            
            <li class="divider"></li>
            <li><a href='http://runestoneinteractive.org'>Acerca de Runestone</a></li>
          </ul>
        </li>
        <!-- end help menu dropdown -->

        <li class="divider-vertical"></li>

      </ul>

    </div>
  </div>
</div>


<div class="container" id="continue-reading"></div>

<div class="container" id="main-content">
  
  <div class="section" id="resolucion-de-sudokus">
<h1>54. Resolución de Sudokus<a class="headerlink" href="#resolucion-de-sudokus" title="Enlazar permanentemente con este título">¶</a></h1>
<p>Ya hemos resuelto el problema de comprobar un Sudoku. Vamos ahora a
hacer un programa que resuelve Sudokus. Plantéatelo como un caso de
estudio que se parece mucho a los problemas de exámen. Para ello vamos a
utilizar clases.</p>
<p>Como siempre utilizaremos un diseño top-down. Empezaremos por resolver
el problema asumiendo que está resuelto cualquier subproblema de más
bajo nivel.</p>
<p>Puede modelarse como un problema de árboles de decisión pero en lugar de
un árbol binario se trata de un árbol con tantas ramas como opciones
disponibles hay en cada casilla. Para validar la solución simplemente
tenemos que intentar construir un Sudoku. Si no fuera posible es que las
nuevas restricciones no son consistentes.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">resolver_sudoku</span><span class="p">(</span><span class="n">sudoku</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Asume sudoku de tipo Sudoku parcialmente especificado.</span>
<span class="sd">       Devuelve un Sudoku solución del que se pasa como argumento.&#39;&#39;&#39;</span>
    <span class="n">restricciones</span> <span class="o">=</span> <span class="p">[</span> <span class="n">sudoku</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="p">]</span>
    <span class="k">return</span> <span class="n">buscar_solucion</span><span class="p">(</span><span class="n">restricciones</span><span class="p">,</span> <span class="n">Sudoku</span><span class="p">)</span>
</pre></div>
</div>
<p>La función <code class="docutils literal"><span class="pre">buscar_solucion</span></code> puede hacerse de forma genérica para
cualquier problema de toma de decisiones dadas unas restricciones y una
clase que se instancia (o una función que se llama) con esas
restricciones.</p>
<p>El funcionamiento es muy simple. La función debe ir fijando valores para
cada casilla y probar todos los demás valores en las siguientes
casillas. Así en un momento dado tendremos una serie de valores ya
fijados y la misma función <code class="docutils literal"><span class="pre">buscar_solucion</span></code> se invocará para probar
todos los valores que permiten las restricciones a partir de un punto
dado.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">buscar_solucion</span><span class="p">(</span><span class="n">restricciones</span><span class="p">,</span> <span class="n">solucion</span><span class="p">,</span> <span class="n">desde</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Asume &#39;restricciones&#39; una lista de listas,</span>
<span class="sd">       &#39;solucion&#39; una clase o función,</span>
<span class="sd">       &#39;desde&#39; un entero &lt;= len(restricciones).</span>
<span class="sd">       Si solucion(x) no es válida &#39;solucion&#39; eleva ValueError.</span>

<span class="sd">       Devuelve el resultado de llamar a solucion con un conjunto</span>
<span class="sd">       de restricciones completo (cada elemento tiene un solo elemento).</span>
<span class="sd">       Si no existe ninguna solución válida eleva excepción ValueError.&#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">desde</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">restricciones</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">solucion</span><span class="p">(</span><span class="n">restricciones</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">restricciones</span><span class="p">[</span><span class="n">desde</span><span class="p">]:</span>
        <span class="n">tentativa</span> <span class="o">=</span> <span class="n">restricciones</span><span class="p">[:</span><span class="n">desde</span><span class="p">]</span> <span class="o">+</span> <span class="p">[[</span><span class="n">i</span><span class="p">]]</span> <span class="o">+</span> <span class="n">restricciones</span><span class="p">[</span><span class="n">desde</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
        <span class="k">try</span><span class="p">:</span> <span class="k">return</span> <span class="n">buscar_solucion</span><span class="p">(</span><span class="n">tentativa</span><span class="p">,</span> <span class="n">solucion</span><span class="p">,</span> <span class="n">desde</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span> <span class="k">pass</span>

    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;No hay solución&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Probemos con un ejemplo sencillo.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sol</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Repetidos&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span>

<span class="nb">print</span><span class="p">(</span><span class="n">buscar_solucion</span><span class="p">([[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]],</span> <span class="n">sol</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">]]</span>
</pre></div>
</div>
<div class="section" id="modelo-de-sudoku">
<h2>54.1. Modelo de Sudoku<a class="headerlink" href="#modelo-de-sudoku" title="Enlazar permanentemente con este título">¶</a></h2>
<p>En lo que hemos hecho hasta ahora necesitamos una clase <code class="docutils literal"><span class="pre">Sudoku</span></code> que
se pueda construir a partir de una lista de restricciones y que tenga un
método <code class="docutils literal"><span class="pre">get</span></code> para obtener el elemento de coordenadas dadas. Cada
elemento es una lista de números posibles.</p>
<p>Conviene pararnos a pensar en los invariantes de representación que debe
garantizar la clase <code class="docutils literal"><span class="pre">Sudoku</span></code>. Por un lado debe garantizar que cada
celda tiene solo números de 1 a 9. Por otro lado debe garantizar que en
cada columna, en cada fila y en cada bloque hay posibilidad de tener
todos los números de 1 a 9.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Sudoku</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="s1">&#39;Sudoku modela un juego de sudoku parcialmente especificado&#39;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">restricciones</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Asume restricciones lista de listas.</span>
<span class="sd">           Construye un Sudoku dadas unas restricciones.</span>
<span class="sd">           Las restricciones se especifican for filas y contienen</span>
<span class="sd">           todos los números permitidos en cada casilla&#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rep</span> <span class="o">=</span> <span class="p">[</span> <span class="n">restricciones</span><span class="p">[</span><span class="n">y</span><span class="o">*</span><span class="mi">9</span><span class="p">:][:</span><span class="mi">9</span><span class="p">]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_comprobar</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Asume x, y enteros pertenecientes a range(9).</span>
<span class="sd">           Devuelve el contenido de la celda de coordenadas x,y.&#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rep</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s1">&#39;Devuelve cadena que representa al Sudoku&#39;</span>
        <span class="k">def</span> <span class="nf">str_fila</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
            <span class="k">return</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">str_celda</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">f</span><span class="p">])</span>
        <span class="k">def</span> <span class="nf">str_celda</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
            <span class="k">return</span> <span class="s1">&#39;[&#39;</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">c</span> <span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;]&#39;</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span> <span class="n">str_fila</span><span class="p">(</span><span class="n">fila</span><span class="p">)</span> <span class="k">for</span> <span class="n">fila</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rep</span> <span class="p">])</span>

    <span class="k">def</span> <span class="nf">_comprobar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Comprueba los invariantes de representación y eleva</span>
<span class="sd">           ValueError si no se cumplen&#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_comprobar_celdas</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_comprobar_filas</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_comprobar_columnas</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_comprobar_bloques</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_comprobar_celdas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>
                <span class="n">_comprobarNum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rep</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">_comprobar_filas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>
            <span class="n">_comprobar9</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rep</span><span class="p">[</span><span class="n">y</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">_comprobar_columnas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>
            <span class="n">_comprobar9</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_rep</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)])</span>

    <span class="k">def</span> <span class="nf">_comprobar_bloques</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                <span class="n">_comprobar9</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_rep</span><span class="p">[</span><span class="n">y</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="n">j</span><span class="p">][</span><span class="n">x</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>
</pre></div>
</div>
</div>
<div class="section" id="comprobaciones-del-invariante-de-representacion">
<h2>54.2. Comprobaciones del invariante de representación<a class="headerlink" href="#comprobaciones-del-invariante-de-representacion" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Hemos delegado las comprobaciones en una función <code class="docutils literal"><span class="pre">comprobarNum</span></code>que
comprueba que cada elemento de una casilla es una cifra válida, y
<code class="docutils literal"><span class="pre">_comprobar9</span></code> que comprueba la consistencia de nueve casillas con cada
una de las nueve cifras del 1 al 9. A su vex ésta puede delegar en
<code class="docutils literal"><span class="pre">_comprobar1</span></code> que comprueba la consistencia una cifra en particular:</p>
<ul class="simple">
<li>Verifica que la cifra exista en alguna de las casillas.</li>
<li>Verifica que si hay casillas fijas esos valores no aparecen en el
resto de casillas.</li>
</ul>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">_comprobar9</span><span class="p">(</span><span class="n">L</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Asume L lista de listas.</span>
<span class="sd">       Eleva excepción ValueError si L corresponde a conjunto</span>
<span class="sd">       no consistente de restricciones. Se define &#39;&#39;&#39;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">_comprobar1</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">_comprobar1</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Asume L lista de listas, n entero in range(1,10).</span>
<span class="sd">       Eleva excepción si L no corresponde a un conjunto de</span>
<span class="sd">       de restricciones válido con respecto al número n.&#39;&#39;&#39;</span>
    <span class="n">cont</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">c</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">L</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">cont</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Falta &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="n">fijos</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">c</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">L</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">fijos</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Sobra &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">_comprobarNum</span><span class="p">(</span><span class="n">celda</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Asume celda lista.</span>
<span class="sd">       Eleva excepción si algún elemento no es dígito de 1 a 9&#39;&#39;&#39;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">celda</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Valor &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; no válido&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">Sudoku</span><span class="p">([</span>
<span class="p">[</span><span class="mi">2</span><span class="p">],</span>    <span class="p">[</span><span class="mi">8</span><span class="p">],</span>    <span class="p">[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">7</span><span class="p">],</span>  <span class="p">[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">6</span><span class="p">],</span>    <span class="p">[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">3</span><span class="p">],</span>
<span class="p">[</span><span class="mi">7</span><span class="p">],</span>    <span class="p">[</span><span class="mi">6</span><span class="p">],</span>    <span class="p">[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">9</span><span class="p">],</span>  <span class="p">[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">8</span><span class="p">],</span>    <span class="p">[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">4</span><span class="p">],</span>
<span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">9</span><span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span><span class="p">],</span>  <span class="p">[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">7</span><span class="p">],</span>
<span class="p">[</span><span class="mi">6</span><span class="p">],</span>    <span class="p">[</span><span class="mi">4</span><span class="p">],</span>    <span class="p">[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">],</span>  <span class="p">[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">7</span><span class="p">],</span>    <span class="p">[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">8</span><span class="p">],</span>
<span class="p">[</span><span class="mi">3</span><span class="p">],</span>    <span class="p">[</span><span class="mi">7</span><span class="p">],</span>    <span class="p">[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">8</span><span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">5</span><span class="p">],</span>    <span class="p">[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">9</span><span class="p">],</span>
<span class="p">[</span><span class="mi">8</span><span class="p">],</span>    <span class="p">[</span><span class="mi">9</span><span class="p">],</span>    <span class="p">[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">6</span><span class="p">],</span>  <span class="p">[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">],</span>    <span class="p">[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">9</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span>  <span class="p">[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">9</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">6</span><span class="p">],</span>
<span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span>  <span class="p">[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">2</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">],</span>    <span class="p">[</span><span class="mi">2</span><span class="p">],</span>    <span class="p">[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">4</span><span class="p">],</span>  <span class="p">[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">3</span><span class="p">],</span>    <span class="p">[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">5</span><span class="p">]])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">resolver_sudoku</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">3</span><span class="p">]</span>
<span class="p">[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">4</span><span class="p">]</span>
<span class="p">[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">7</span><span class="p">]</span>
<span class="p">[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">8</span><span class="p">]</span>
<span class="p">[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">9</span><span class="p">]</span>
<span class="p">[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">1</span><span class="p">]</span>
<span class="p">[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">6</span><span class="p">]</span>
<span class="p">[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">2</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="creacion-de-sudokus">
<h2>54.3. Creación de Sudokus<a class="headerlink" href="#creacion-de-sudokus" title="Enlazar permanentemente con este título">¶</a></h2>
<p>El constructor de Sudokus requiere una especificación de restricciones
que puede ser un poco engorrosa de teclear. Para facilitar eso se puede
hacer un <em>builder</em>, una función o clase que ayuda a construir Sudokus a
partir de elementos más simples, como cadenas de texto.</p>
<p>Empezaremos por la versión más simple, en la que las celdas vacías
equivalen a no tener ningún tipo de restricción. Es decir, el valor de
la celda corresponde a <code class="docutils literal"><span class="pre">range(1,10)</span></code>.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">crearSudoku</span><span class="p">(</span><span class="n">desc</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Asume desc una cadena que describe el Sudoku.</span>
<span class="sd">       Devuelve un Sudoku que corresponde a dicha descripción.&#39;&#39;&#39;</span>
    <span class="n">restricciones</span> <span class="o">=</span> <span class="p">[</span> <span class="n">crearCelda</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">desc</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">i</span> <span class="ow">in</span> <span class="s1">&#39; </span><span class="se">\r\n</span><span class="s1">&#39;</span> <span class="p">]</span>
    <span class="k">return</span> <span class="n">Sudoku</span><span class="p">(</span><span class="n">restricciones</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">crearCelda</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Asume c un caracter que representa una celda.</span>
<span class="sd">       Devuelve la restricción correspondiente.</span>
<span class="sd">       &#39;.&#39; se interpreta como celda sin rellenar.&#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;.&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="s1">&#39;123456789&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span> <span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="p">]</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Caracter &#39;</span> <span class="o">+</span> <span class="n">c</span> <span class="o">+</span> <span class="s1">&#39; inválido&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">crearSudoku</span><span class="p">(</span>
<span class="sd">&#39;&#39;&#39;.....56..</span>
<span class="sd">   76......4</span>
<span class="sd">   .....8.27</span>
<span class="sd">   .4.2...38</span>
<span class="sd">   37...45..</span>
<span class="sd">   .9.6.324.</span>
<span class="sd">   ..8.32..6</span>
<span class="sd">   ....86..2</span>
<span class="sd">   .264.....&#39;&#39;&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">]</span>
<span class="p">[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">4</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">7</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">8</span><span class="p">]</span>
<span class="p">[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">6</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">2</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">]</span>
</pre></div>
</div>
<p>Sin embargo no nos podemos plantear resolver el sudoku con estas
restricciones. Hay demasiadas posibilidades. ¿Sabes cuántas? Prueba a
calcularlas con un pequeño programita. Si te rindes mira más adelante en
este documento.</p>
<p>Una forma efectiva es eliminar de las casillas no fijas aquellos números
que están en las casillas fijas de la misma columna, fila o grupo.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">crearSudoku</span><span class="p">(</span><span class="n">desc</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Asume desc una cadena que describe el Sudoku.</span>
<span class="sd">       Devuelve un Sudoku que corresponde a dicha descripción.&#39;&#39;&#39;</span>
    <span class="n">restricciones</span> <span class="o">=</span> <span class="p">[</span> <span class="n">crearCelda</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">desc</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">i</span> <span class="ow">in</span> <span class="s1">&#39; </span><span class="se">\r\n</span><span class="s1">&#39;</span> <span class="p">]</span>
    <span class="n">filtrarRestricciones</span><span class="p">(</span><span class="n">restricciones</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Sudoku</span><span class="p">(</span><span class="n">restricciones</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">filtrarRestricciones</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Asume r una lista de listas.</span>
<span class="sd">       Elimina de los elementos de r todos aquellos candidatos que ya</span>
<span class="sd">       están en una celda fija de la misma fila, columna o bloque. Una</span>
<span class="sd">       celda fija es aquella en la que solo hay un candidato.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">nuevos_fijos</span> <span class="o">=</span> <span class="n">filtrarFilas</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> \
                       <span class="ow">or</span> <span class="n">filtrarColumnas</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> \
                       <span class="ow">or</span> <span class="n">filtrarBloques</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">nuevos_fijos</span><span class="p">:</span> <span class="k">break</span>

<span class="k">def</span> <span class="nf">filtrarFilas</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Asume r lista de listas.</span>
<span class="sd">       Elimina de los elementos de r los candidatos que ya están</span>
<span class="sd">       en una celda fija de la misma fila.</span>
<span class="sd">       Devuelve True si han aparecido nuevas celdas fijas y False</span>
<span class="sd">       en caso contrario.&#39;&#39;&#39;</span>
    <span class="n">nuevos_fijos</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>
        <span class="n">nuevos_fijos</span> <span class="o">=</span> <span class="n">nuevos_fijos</span> <span class="ow">or</span> <span class="n">eliminarRepetidos</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">9</span><span class="p">:(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">9</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">nuevos_fijos</span>

<span class="k">def</span> <span class="nf">filtrarColumnas</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Asume r lista de listas.</span>
<span class="sd">       Elimina de los elementos de r los candidatos que ya están</span>
<span class="sd">       en una celda fija de la misma columna.</span>
<span class="sd">       Devuelve True si han aparecido nuevas celdas fijas y False</span>
<span class="sd">       en caso contrario.&#39;&#39;&#39;</span>
    <span class="n">nuevos_fijos</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>
        <span class="n">nuevos_fijos</span> <span class="o">=</span> <span class="n">nuevos_fijos</span> <span class="ow">or</span> <span class="n">eliminarRepetidos</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">::</span><span class="mi">9</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">nuevos_fijos</span>

<span class="k">def</span> <span class="nf">filtrarBloques</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Asume r lista de listas.</span>
<span class="sd">       Elimina de los elementos de r los candidatos que ya están</span>
<span class="sd">       en una celda fija del mismo bloque.</span>
<span class="sd">       Devuelve True si han aparecido nuevas celdas fijas y False</span>
<span class="sd">       en caso contrario.&#39;&#39;&#39;</span>
    <span class="n">nuevos_fijos</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">nuevos_fijos</span> <span class="o">=</span> <span class="n">nuevos_fijos</span> <span class="ow">or</span> <span class="n">filtrarBloque</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">nuevos_fijos</span>

<span class="k">def</span> <span class="nf">filtrarBloque</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Asume r lista de listas, x e y enteros.</span>
<span class="sd">       Elimina de los elementos de r los candidatos que ya están</span>
<span class="sd">       en una celda fija del bloque que empieza en las coordenadas</span>
<span class="sd">       (x, y).</span>
<span class="sd">       Devuelve True si han aparecido nuevas celdas fijas y False</span>
<span class="sd">       en caso contrario.&#39;&#39;&#39;</span>
    <span class="n">l</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">o</span> <span class="o">=</span> <span class="n">y</span><span class="o">*</span><span class="mi">9</span><span class="o">+</span><span class="n">x</span>
    <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">o</span><span class="o">+</span><span class="mi">27</span><span class="p">,</span> <span class="mi">9</span><span class="p">):</span>
        <span class="n">l</span> <span class="o">+=</span> <span class="n">r</span><span class="p">[</span><span class="n">o</span><span class="p">:</span><span class="n">o</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">nuevos_fijos</span> <span class="o">=</span> <span class="n">eliminarRepetidos</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
    <span class="n">o</span> <span class="o">=</span> <span class="n">y</span><span class="o">*</span><span class="mi">9</span><span class="o">+</span><span class="n">x</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">r</span><span class="p">[</span><span class="n">o</span><span class="p">:</span><span class="n">o</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">o</span> <span class="o">+=</span> <span class="mi">9</span>
    <span class="k">return</span> <span class="n">nuevos_fijos</span>
</pre></div>
</div>
<p>Queda la función para eliminar repetidos en un conjunto de nueve
restricciones (fila, columna o bloque).</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">eliminarRepetidos</span><span class="p">(</span><span class="n">L</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Asume L lista de nueve restricciones.</span>
<span class="sd">       Elimina elementos que ya están en una celda fija.</span>
<span class="sd">       Una celda fija es aquella que solo tiene un elemento.</span>
<span class="sd">       Devuelve True si han aparecido nuevas celdas fijas y False</span>
<span class="sd">       en caso contrario.&#39;&#39;&#39;</span>
    <span class="n">nuevos_fijos</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">L</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">nuevos_fijos</span> <span class="o">=</span> <span class="n">nuevos_fijos</span> <span class="ow">or</span> <span class="n">eliminarFijoRepetido</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">nuevos_fijos</span>

<span class="k">def</span> <span class="nf">eliminarFijoRepetido</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Asume L lista de nueve restricciones, n cifra de 1 a 9.</span>
<span class="sd">       Elimina las apariciones de n en las celdas de L con más de un</span>
<span class="sd">       elemento.</span>
<span class="sd">       Devuelve True si han aparecido nuevas celdas fijas y False</span>
<span class="sd">       en caso contrario.&#39;&#39;&#39;</span>
    <span class="n">nuevos_fijos</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">L</span><span class="p">:</span>
        <span class="n">nuevos_fijos</span> <span class="o">=</span> <span class="n">nuevos_fijos</span> <span class="ow">or</span> <span class="n">eliminarCandidato</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">nuevos_fijos</span>

<span class="k">def</span> <span class="nf">eliminarCandidato</span><span class="p">(</span><span class="n">celda</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Asume celda lista de cifras de 1 a 9, n cifra de 1 a 9.</span>
<span class="sd">       Elimina n de la celda si estaba.</span>
<span class="sd">       Devuelve True si celda tenía a n y ha quedado con un solo</span>
<span class="sd">       elemento y False en caso contrario.&#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">celda</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">celda</span><span class="p">:</span>
        <span class="n">celda</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">celda</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>
</pre></div>
</div>
<p>No pienses que todo este código ha salido funcionando a la primera.
Siempre hay errores, siempre hay que aplicar el método que hemos
descrito en clase para encontrar los errores.</p>
<p>Pero no esperes a tener todo escrito. Prueba las funciones conforme las
vayas escribiendo. Por ejemplo, esta podría ser una prueba de
<code class="docutils literal"><span class="pre">filtrarBloque</span></code>.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">prueba_filtrarBloque</span><span class="p">():</span>
    <span class="n">r</span> <span class="o">=</span> <span class="p">[</span> \
<span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">],</span>
<span class="p">[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">6</span><span class="p">],</span>
<span class="p">[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">4</span><span class="p">],</span>
<span class="p">[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">9</span><span class="p">],</span>
<span class="p">[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">7</span><span class="p">],</span>
<span class="p">[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">3</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">8</span><span class="p">],</span>
<span class="p">[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">5</span><span class="p">]]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">filtrarBloque</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

<span class="n">prueba_filtrarBloque</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kc">True</span>
<span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">]]</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">crearSudoku</span><span class="p">(</span>
<span class="sd">&#39;&#39;&#39;.....56..</span>
<span class="sd">   76......4</span>
<span class="sd">   .....8.27</span>
<span class="sd">   .4.2...38</span>
<span class="sd">   37...45..</span>
<span class="sd">   .9.6.324.</span>
<span class="sd">   ..8.32..6</span>
<span class="sd">   ....86..2</span>
<span class="sd">   .264.....&#39;&#39;&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">3</span><span class="p">]</span>
<span class="p">[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">4</span><span class="p">]</span>
<span class="p">[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">7</span><span class="p">]</span>
<span class="p">[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">8</span><span class="p">]</span>
<span class="p">[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">9</span><span class="p">]</span>
<span class="p">[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">1</span><span class="p">]</span>
<span class="p">[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">6</span><span class="p">]</span>
<span class="p">[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">2</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
<p>La eliminación de los elementos fijos es muy efectiva pero no elimina
completamente las incertidumbres en todos los casos. Prueba con Sudokus
difíciles para ver algún ejemplo.</p>
<p>Evidentemente si resolvemos un Sudoku completamente especificado resulta
en lo mismo.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">resolver_sudoku</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">3</span><span class="p">]</span>
<span class="p">[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">4</span><span class="p">]</span>
<span class="p">[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">7</span><span class="p">]</span>
<span class="p">[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">8</span><span class="p">]</span>
<span class="p">[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">9</span><span class="p">]</span>
<span class="p">[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">1</span><span class="p">]</span>
<span class="p">[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">6</span><span class="p">]</span>
<span class="p">[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">2</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="restricciones-con-clases">
<h2>54.4. Restricciones con clases<a class="headerlink" href="#restricciones-con-clases" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Vamos a pararnos por un momento en el análisis de cómo hemos resuelto el
filtrado de las restricciones. ¿No te has sentido incómodo con tanto
paso de parámetros repetidos? Las clases tienen una ventaja. El paso de
parámetros es en su mayor parte innecesario, porque podemos almacenar
los resultados interesantes en los datos del propio objeto (como un
atributo).</p>
<p>Para ilustrar esto vamos a volver a escribir el filtrado de las
restricciones, pero esta vez con una clase que modele las propias
restricciones.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Restricciones</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">L</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Asume L lista de listas con las restricciones.</span>
<span class="sd">           Construye un objeto Restricciones eliminando</span>
<span class="sd">           las innecesarias&#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rep</span> <span class="o">=</span> <span class="n">L</span><span class="p">[:]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nuevos_fijos</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_filtrar</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rep</span><span class="p">[:]</span>

    <span class="k">def</span> <span class="nf">_filtrar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Elimina todos aquellos candidatos que ya</span>
<span class="sd">           están en una celda fija de la misma fila,</span>
<span class="sd">           columna o bloque. Una celda fija es aquella</span>
<span class="sd">           en la que solo hay un candidato.&#39;&#39;&#39;</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nuevos_fijos</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_nuevos_fijos</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_filtrarFilas</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_filtrarColumnas</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_filtrarBloques</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_filtrarFilas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Elimina de los elementos de _rep los candidatos</span>
<span class="sd">           que ya están en una celda fija de la misma fila.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_eliminarRepetidos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rep</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">9</span><span class="p">:(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">9</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">_filtrarColumnas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Elimina de los elementos de _rep los candidatos</span>
<span class="sd">           que ya están en una celda fija de la misma columna.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_eliminarRepetidos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rep</span><span class="p">[</span><span class="n">i</span><span class="p">::</span><span class="mi">9</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">_filtrarBloques</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Elimina de los elementos de _rep los candidatos</span>
<span class="sd">           que ya están en una celda fija del mismo bloque.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_filtrarBloque</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_filtrarBloque</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Asume x e y enteros.</span>
<span class="sd">           Elimina de los elementos de _rep los candidatos</span>
<span class="sd">           que ya están en una celda fija del bloque que empieza</span>
<span class="sd">           en las coordenadas (x, y).</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">l</span><span class="p">,</span> <span class="n">o</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">y</span><span class="o">*</span><span class="mi">9</span><span class="o">+</span><span class="n">x</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">o</span><span class="o">+</span><span class="mi">27</span><span class="p">,</span> <span class="mi">9</span><span class="p">):</span>
            <span class="n">l</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rep</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_eliminarRepetidos</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rep</span><span class="p">[</span><span class="n">o</span><span class="p">:</span><span class="n">o</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span>
            <span class="n">o</span> <span class="o">+=</span> <span class="mi">9</span>

    <span class="k">def</span> <span class="nf">_eliminarRepetidos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">L</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Asume L lista de nueve restricciones.</span>
<span class="sd">           Elimina elementos que ya están en una celda fija.</span>
<span class="sd">           Una celda fija es aquella que solo tiene un elemento.</span>
<span class="sd">           Pone _nuevos_fijos a True si han aparecido nuevas</span>
<span class="sd">           celdas fijas.&#39;&#39;&#39;</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">L</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_eliminarFijoRepetido</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">_eliminarFijoRepetido</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Asume L lista de nueve restricciones, n cifra de 1 a 9.</span>
<span class="sd">           Elimina las apariciones de n en las celdas de L con más de</span>
<span class="sd">           un elemento.</span>
<span class="sd">           Pone _nuevos_fijos a True si han aparecido nuevas</span>
<span class="sd">           celdas fijas.&#39;&#39;&#39;</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">L</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_eliminarCandidato</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_eliminarCandidato</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">celda</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Asume celda lista de cifras de 1 a 9, n cifra de 1 a 9.</span>
<span class="sd">           Elimina n de la celda si estaba.</span>
<span class="sd">           Pone _nuevos_fijos a True si han aparecido nuevas</span>
<span class="sd">           celdas fijas.&#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">celda</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">celda</span><span class="p">:</span>
            <span class="n">celda</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">celda</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_nuevos_fijos</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
<p>Es bastante más breve, pero no acaban ahí las ventajas.</p>
<p>Ya no es necesario cargar al <em>builder</em> con la responsabilidad de
mantener el invariante de representación de las restricciones. Lo hace
directamente la clase <code class="docutils literal"><span class="pre">Restricciones</span></code>.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">crearSudoku</span><span class="p">(</span><span class="n">desc</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Asume desc una cadena que describe el Sudoku.</span>
<span class="sd">       Devuelve un Sudoku que corresponde a dicha descripción.&#39;&#39;&#39;</span>
    <span class="n">restricciones</span> <span class="o">=</span> <span class="n">Restricciones</span><span class="p">([</span> <span class="n">crearCelda</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">desc</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">i</span> <span class="ow">in</span> <span class="s1">&#39; </span><span class="se">\r\n</span><span class="s1">&#39;</span> <span class="p">])</span>
    <span class="k">return</span> <span class="n">Sudoku</span><span class="p">(</span><span class="n">restricciones</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">crearSudoku</span><span class="p">(</span>
<span class="sd">&#39;&#39;&#39;.....56..</span>
<span class="sd">   76......4</span>
<span class="sd">   .....8.27</span>
<span class="sd">   .4.2...38</span>
<span class="sd">   37...45..</span>
<span class="sd">   .9.6.324.</span>
<span class="sd">   ..8.32..6</span>
<span class="sd">   ....86..2</span>
<span class="sd">   .264.....&#39;&#39;&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">SOLUCIÓN:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">resolver_sudoku</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">3</span><span class="p">]</span>
<span class="p">[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">4</span><span class="p">]</span>
<span class="p">[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">7</span><span class="p">]</span>
<span class="p">[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">8</span><span class="p">]</span>
<span class="p">[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">9</span><span class="p">]</span>
<span class="p">[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">1</span><span class="p">]</span>
<span class="p">[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">6</span><span class="p">]</span>
<span class="p">[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">2</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">5</span><span class="p">]</span>

<span class="n">SOLUCIÓN</span><span class="p">:</span>
<span class="p">[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">3</span><span class="p">]</span>
<span class="p">[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">4</span><span class="p">]</span>
<span class="p">[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">7</span><span class="p">]</span>
<span class="p">[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">8</span><span class="p">]</span>
<span class="p">[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">9</span><span class="p">]</span>
<span class="p">[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">1</span><span class="p">]</span>
<span class="p">[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">6</span><span class="p">]</span>
<span class="p">[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">2</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
<p>Usar clases desde las primeras etapas del diseño hace que no nos
preocupemos de los detalles (mantener los invariantes de representación)
y nos centremos en el problema desde una perspectiva más orientada a los
datos.</p>
</div>
<div class="section" id="sudokus-dificiles">
<h2>54.5. Sudokus difíciles<a class="headerlink" href="#sudokus-dificiles" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Los sudokus más elementales se resuelven con suma facilidad. Sin embargo
hay sudokus mucho más complejos. Puedes probar con
<a class="reference external" href="http://www.sudoku-online.org/">sudoku-online</a> con el máximo grado de
dificultad para ver a qué me refiero.</p>
<p>Puede resultarte útil calcular el número de posibilidades a explorar.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">posibilidades</span><span class="p">(</span><span class="n">sudoku</span><span class="p">):</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span> <span class="nb">len</span><span class="p">(</span><span class="n">sudoku</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="p">]:</span>
        <span class="n">ret</span> <span class="o">*=</span> <span class="n">i</span>
    <span class="k">return</span> <span class="n">ret</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">crearSudoku</span><span class="p">(</span>
<span class="sd">&#39;&#39;&#39;.7.8..2..</span>
<span class="sd">   .48......</span>
<span class="sd">   .3......6</span>
<span class="sd">   ..3.8.7..</span>
<span class="sd">   .2..49.35</span>
<span class="sd">   ....5....</span>
<span class="sd">   8..52..79</span>
<span class="sd">   ...6.....</span>
<span class="sd">   4.....3..&#39;&#39;&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">posibilidades</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">1754956051230228480000000000000000</span>
<span class="p">[</span><span class="mi">1</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">3</span> <span class="mi">6</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">7</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">3</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">5</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">5</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">3</span> <span class="mi">7</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">5</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">5</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">4</span> <span class="mi">7</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">7</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">7</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">6</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span><span class="p">],[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">6</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">4</span> <span class="mi">6</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">4</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span> <span class="mi">6</span> <span class="mi">7</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">6</span> <span class="mi">7</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">7</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">6</span> <span class="mi">8</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">5</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">6</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">4</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">7</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">6</span> <span class="mi">7</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">4</span> <span class="mi">6</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">4</span> <span class="mi">6</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">4</span> <span class="mi">8</span><span class="p">]</span>
<span class="p">[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">6</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">6</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">4</span> <span class="mi">6</span><span class="p">],[</span><span class="mi">7</span><span class="p">],[</span><span class="mi">9</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">5</span> <span class="mi">7</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">5</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">5</span> <span class="mi">7</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">6</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">3</span> <span class="mi">7</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">7</span> <span class="mi">8</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">8</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">8</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">4</span> <span class="mi">8</span><span class="p">]</span>
<span class="p">[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">7</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">7</span> <span class="mi">9</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">7</span> <span class="mi">8</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">8</span><span class="p">],[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">8</span><span class="p">]</span>
</pre></div>
</div>
<p>Estamos hablando de más de 1700 quintillones de posibilidades (1700
billones de trillones). No queda más remedio que explorar otras
posibilidades. Una posible estrategia es aplicar otro tipo de filtrado.</p>
<p>Por ejemplo, si dentro de una fila, columna o bloque solo hay una celda
donde se puede poner determinada cifra entonces podemos fijarla. Podemos
ilustrarlo con la siguiente línea del sudoku anterior:</p>
<p><code class="docutils literal"><span class="pre">[1</span> <span class="pre">6</span> <span class="pre">7],[2],[1</span> <span class="pre">6</span> <span class="pre">7],[1</span> <span class="pre">7],[4],[9],[1</span> <span class="pre">6</span> <span class="pre">8],[3],[5]</span></code></p>
<p>Solo hay una celda donde se puede poner el 8, así que podemos fijarla y
descartar los otros candidatos.</p>
<p>Otro ejemplo, si hay dos celdas en cualquier fila, columna o bloque que
contienen los mismos dos números (y ningún otro), entonces ninguna otra
puede contener esos números. Por ejemplo:</p>
<p><code class="docutils literal"><span class="pre">[[1,2],</span> <span class="pre">[1,2],</span> <span class="pre">[1,3],</span> <span class="pre">[5],</span> <span class="pre">[4],</span> <span class="pre">[6],</span> <span class="pre">[7],</span> <span class="pre">[8],</span> <span class="pre">...</span></code></p>
<p>En este caso las dos primeras celdas tienen el 1 y el 2 y ningún otro.
Si una tiene el 1, la otra tiene que ser el 2 y viceversa. Por tanto ni
el 1 ni el 2 pueden estar en el resto de la fila, columna o bloque. En
particular la tercera casilla se puede simplificar a un <code class="docutils literal"><span class="pre">[3]</span></code>.</p>
<p>Lo mismo se puede aplicar con un conjunto de tres casillas y tres
números. Si entre tres casillas comparten solo tres números entonces el
resto de casillas de la fila, columna o bloque no pueden tener ninguno
de esos números. Un ejemplo lo tenemos en la misma fila conocida del
sudoku anterior:</p>
<p><code class="docutils literal"><span class="pre">[1</span> <span class="pre">6</span> <span class="pre">7],[2],[1</span> <span class="pre">6</span> <span class="pre">7],[1</span> <span class="pre">7],[4],[9],[1</span> <span class="pre">6</span> <span class="pre">8],[3],[5]</span></code></p>
<p>Las casillas <code class="docutils literal"><span class="pre">[1</span> <span class="pre">6</span> <span class="pre">7]</span> <span class="pre">...</span> <span class="pre">[1</span> <span class="pre">6</span> <span class="pre">7]</span> <span class="pre">y</span> <span class="pre">[1</span> <span class="pre">7]</span></code> comparten entre ellas solo
tres números. Por tanto la casilla <code class="docutils literal"><span class="pre">[1</span> <span class="pre">6</span> <span class="pre">8]</span></code> no puede tener ninguno de
los tres, con lo que quedaría en un <code class="docutils literal"><span class="pre">[8]</span></code>.</p>
<p>Prueba a implementar alguna de estas estrategias. ¿Puedes generalizarlas
para que el caso que hemos implementado sea un caso particular?</p>
<p>Puede que te interese <a class="reference external" href="http://norvig.com/sudoku.html">este otro
método</a> de Peter Norvig, que utiliza
un modelo mucho más flexible que le permite ordenar la búsqueda en el
sentido que más le convenga para tener mayores probabilidades de
encontrar la solución antes.</p>
</div>
</div>


  
      
  <li id="relations-prev" class="navLink" title='Capítulo anterior - 53. Sopa de letras' data-toggle="tooltip">
    <a href="sopa_letras.html" >
      <i class='prevNav glyphicon glyphicon-chevron-left'></i>
    </a>
  </li>
  <a class="navLinkBg" id="navLinkBgLeft"  href="sopa_letras.html" ></a>
  
  <li id="relations-next" class="navLink" title='Capítulo siguiente - 55. Sudoku al estilo de P. Norvig' data-toggle="tooltip" >
    <a href="Sudoku 3.html" >
      <i id="relationsNextIcon" class='nextNav glyphicon glyphicon-chevron-right'></i>
    </a>
  </li>
  <a class="navLinkBg navLink" id="navLinkBgRight" href="Sudoku 3.html" >Next Section - 55. Sudoku al estilo de P. Norvig</a>

<script type="text/javascript">

  $('#relations-prev').tooltip({'placement':'right', 'selector': '', 'delay': { show: 100, hide: 50}});
  $('#relations-next').tooltip({'placement':'left', 'selector': '', 'delay': { show: 100, hide: 50}});
  
</script>
  
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      
      | <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2017 Francisco Moya.
    </p>
  </div>
</footer>



<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-32029811-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>



  </body>
</html>